2025-03-03 15:32:31,668 - INFO - base_attack_script - base_attack_script.py:72 - Testing Attack @ 2025-03-03 15:32:31.668078+08:00
2025-03-03 15:32:47,206 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:32:58,832 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:33:09,559 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:33:31,592 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:33:43,154 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:33:52,881 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:34:00,920 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:34:12,513 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:34:21,948 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:34:44,817 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:34:56,891 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:35:06,296 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:35:16,069 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:35:28,150 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:35:38,002 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:36:00,973 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:36:15,957 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:36:28,771 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:36:49,714 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:37:02,204 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:37:11,739 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:37:47,924 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:38:00,700 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:38:16,687 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:38:28,378 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:38:41,150 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:38:51,808 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:39:08,066 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:39:19,417 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:39:28,324 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:40:44,807 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:40:44,938 - ERROR - RagFlow - RagFlow.py:227 - Error at Target Model Callback: 'generator' object has no attribute 'content'
2025-03-03 15:41:11,597 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:41:58,750 - INFO - _client - _client.py:1038 - HTTP Request: POST http://localhost:11434/api/chat "HTTP/1.1 200 OK"
2025-03-03 15:43:21,487 - ERROR - __init__ - __init__.py:154 - Failed to detach context
Traceback (most recent call last):
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\opentelemetry\trace\__init__.py", line 589, in use_span
    yield span
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\opentelemetry\sdk\trace\__init__.py", line 1105, in start_as_current_span
    yield span
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\telemetry.py", line 237, in capture_red_teamer_run
    yield span
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\red_teamer.py", line 299, in a_scan
    await self.attack_synthesizer.a_generate_attacks(
GeneratorExit

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\opentelemetry\context\__init__.py", line 152, in detach
    _RUNTIME_CONTEXT.detach(token)
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\opentelemetry\context\contextvars_context.py", line 50, in detach
    self._current_context.reset(token)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: <Token var=<ContextVar name='current_context' default={} at 0x00000205E994CC20> at 0x0000020590EBBF80> was created in a different Context
2025-03-03 15:43:21,496 - WARNING - __init__ - __init__.py:213 - Already shutdown, dropping span.
2025-03-03 15:43:21,497 - ERROR - base_events - base_events.py:1785 - Task exception was never retrieved
future: <Task finished name='Task-11' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() done, defined at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "c:\Users\yinki\OneDrive\NUS\BT4103\RAG Model\ragflow_capstone\main.py", line 47, in main
    loop.run_until_complete(run_test())
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 641, in run_until_complete
    self.run_forever()
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 608, in run_forever
    self._run_once()
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1936, in _run_once
    handle._run()
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "c:\Users\yinki\OneDrive\NUS\BT4103\RAG Model\ragflow_capstone\ragflow_python\testing_bot\base_attack_script.py", line 79, in run_test
    results = red_teamer.scan(
              ^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\red_teamer.py", line 119, in scan
    return loop.run_until_complete(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Roaming\Python\Python311\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "C:\Users\yinki\AppData\Roaming\Python\Python311\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py", line 277, in __step
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py", line 179, in throttled_attack_enhancement
    result = await self.a_enhance_attack(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py", line 449, in a_enhance_attack
    enhanced_attack = await JailbreakingCrescendo(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_enhancements\jailbreaking_crescendo\jailbreaking_crescendo.py", line 170, in a_enhance
    enhanced_attack = await self.a_generate_attack(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_enhancements\jailbreaking_crescendo\jailbreaking_crescendo.py", line 334, in a_generate_attack
    res: AttackData = await self._a_generate_schema(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_enhancements\jailbreaking_crescendo\jailbreaking_crescendo.py", line 397, in _a_generate_schema
    return await a_generate_schema(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\utils.py", line 45, in a_generate_schema
    res = await model.a_generate(prompt)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\yinki\OneDrive\NUS\BT4103\RAG Model\ragflow_capstone\ragflow_python\src\CustomGemma2_2b.py", line 23, in a_generate
    return self.generate(prompt)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\yinki\OneDrive\NUS\BT4103\RAG Model\ragflow_capstone\ragflow_python\src\CustomGemma2_2b.py", line 18, in generate
    response = self.client.chat(model=self.model_name, messages=[{"role": "user", "content": prompt}])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\ollama\_client.py", line 333, in chat
    return self._request(
           ^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\ollama\_client.py", line 178, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\ollama\_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2025-03-03 15:43:21,521 - ERROR - base_events - base_events.py:1785 - Task was destroyed but it is pending!
task: <Task pending name='Task-12' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() running at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> cb=[gather.<locals>._done_callback() at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py:764]>
2025-03-03 15:43:21,523 - ERROR - base_events - base_events.py:1785 - Task was destroyed but it is pending!
task: <Task pending name='Task-13' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() running at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> cb=[gather.<locals>._done_callback() at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py:764]>
2025-03-03 15:43:21,523 - ERROR - base_events - base_events.py:1785 - Task was destroyed but it is pending!
task: <Task pending name='Task-14' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() running at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> cb=[gather.<locals>._done_callback() at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py:764]>
2025-03-03 15:43:21,524 - ERROR - base_events - base_events.py:1785 - Task was destroyed but it is pending!
task: <Task pending name='Task-15' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() running at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> cb=[gather.<locals>._done_callback() at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py:764]>
2025-03-03 15:43:21,525 - ERROR - base_events - base_events.py:1785 - Task was destroyed but it is pending!
task: <Task pending name='Task-16' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() running at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> cb=[gather.<locals>._done_callback() at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py:764]>
2025-03-03 15:43:21,526 - ERROR - base_events - base_events.py:1785 - Task was destroyed but it is pending!
task: <Task pending name='Task-17' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() running at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> cb=[gather.<locals>._done_callback() at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py:764]>
2025-03-03 15:43:21,527 - ERROR - base_events - base_events.py:1785 - Task was destroyed but it is pending!
task: <Task pending name='Task-18' coro=<AttackSynthesizer.a_generate_attacks.<locals>.throttled_attack_enhancement() running at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\site-packages\deepeval\red_teaming\attack_synthesizer.py:171> cb=[gather.<locals>._done_callback() at C:\Users\yinki\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py:764]>
